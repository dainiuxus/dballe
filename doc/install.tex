\section {Installing \dballe{} }

\dballe{} should come prepackaged for your system on a {\tt RPM} or {\tt DEB}
package.  If that is the case, you can just install \dballe{} like any other
software in your system.

In case the packages are not good for you, or in case you are the one that
needs to create the package, this section will show all the steps required for
an installation of \dballe{} from scratch.

% see procedure from script on spino
Outline of the procedure:

\begin{enumerate}
\item Install the package dependencies
\item Unpack the source
\item Configure the source
\item Compile the source
\item Install the binaries
\end{enumerate}

\subsection{Install the package dependencies}

This table lists the dependencies of \dballe{}:

\begin{tabular}{|l|l|l|l|}
\hline
{\em Package} & {\em Type of dependency} & {\em Fedora package} & {\rm Debian package} \\
\hline
unixodbc   & Required                        & {\tt } & {\tt unixodbc-dev} \\
gperf      & Required                        & {\tt } & {\tt gperf} \\
popt       & Required                        & {\tt } & {\tt libpopt-dev} \\
CNF        & Only required for the Fortran API & {\tt } & {\tt starmet} (unofficial, contact \dballe{} team) \\
g77        & Only required for unit tests    & {\tt } & {\tt g77} \\
doxygen	   & Only required for documentation & {\tt } & {\tt doxygen} \\
tetex      & Only required for documentation & {\tt } & {\tt tetex-bin} \\
latex2html & Only required for documentation & {\tt } & {\tt latex2html} \\
rst2html   & Optionally required for pretty-printing of the README file & {\tt } & {\tt python-docutils} \\
\end{tabular}


\subsection{Unpack the source}

You should have receved the source tarball of \dballe{} in a file with a name
like ``\tarball{}''.  You can extract it with {\tt tar}: ``{\tt tar xf
\tarball{}}'': this will create the directory ``\sourcedir{}'' with the
extracted source.

Enter the source directory to continue with configuring the source.


\subsection{Configure the source}

\dballe{} sources need to be configured before building, so that they can adapt
to the host architecture and operating system.  \dballe{} uses the standard GNU
Autotools, which you may already be familiar with.  Configuration is done using
the {\tt ./configure} script:

\begin{verbatim}
./configure
\end{verbatim}

\dballe{} allows some extra options to be passed to {\tt configure} to control
the building process, for example to disable building the documentation or the
unit test suite.

These are the \dballe{}-specific parameters you can use to turn off compiling
specific parts of the library:

\begin{description}
\item[\tt --disable-fortran] Disable generation of Fortran bindings.  This allows
			   the code to be compiled without having CNF
			   installed, but the library will be impossible to use
			   from Fortran.
\item[\tt --disable-docs] Disable building of the documentation.  This allows
			   the code to be compiled without having {\tt
			   doxygen}, {\tt tetex} and {\tt latex2html}
			   installed, but there will be little or no
			   documentation.
\end{description}

Other relevant {\tt configure} parameters are:

\begin{description}
\item[{\tt --prefix=dir}] Set the toplevel directory where \dballe{} will be
                     install.  By default this is {\tt /usr/local}.
\item[{\tt --localstatedir=dir}] Set the toplevel directory where \dballe{} will
		     store the indexes for fast-access to the table files.  By
		     default this is {\tt \$prefix/var}, and the table indexes
		     are stored in {\tt \$localstatedir/cache/dballe}.
\item[{\tt --sysconfdir=dir}] Set the toplevel directory where global configuration
		     is kept.  By default this is {\tt \$prefix/etc}, and the
		     configuration is stored in {\tt \$sysconfdir/dballe}.
\item[{\tt --disable-shared}] Disable building shared libraries.  This is a 2x
		     speedup in compilation time, and is very useful when
		     debugging the library.
\end{description}

\subsection{Compile the source}

Compiling the source is as you would expect: you just run ``{\tt make}'' and it
does everything for you.  You can run ``{\tt make check}'' after ``{\tt make}''
to run the library self-test; some tests may fail if a MySQL database named
``test'' is not accessible.

\subsection{Install the binaries}

Installing the binaries follows the usual procedure as well: just run ``{\tt
make install}''.  This will take care of installing all the built files in the
right place.

The installation of \dballe{} is now completed.  Remember that \dballe{}
applications need an ODBC DSN to connect to the database.

The directory layout of \dballe{} after installation is described in
\ref{install-dir-layout}.


\subsection{Optional extra goodies}

Besides what gets installed by {\tt make install}, there are a couple of extra
things left in the source directory after compilation that may be useful:

\begin{description}
\item[{\tt README}] Contains informations about the current state of the
	development of \dballe{}.  It is in reStructuredText format, and you
	can convert it into HTML using the tool {\tt rst2html} from
	{\tt python-docutils}.
\item[{\tt doc/}] Contains the documentation built at build time, unless {\tt
	--disable-docs} was used when configuring the sources.  You probably
	want to copy the relevant parts to a place where users can find it.
\item[{\tt doc/fapi\_html}] Quick guide of the Fortran API, in HTML format.
\item[{\tt doc/fapi.ps}] Quick guide of the Fortran API, in PostScript format.
\item[{\tt doc/dox\_html}] libdballe documentation for the programmer, in HTML format.
\item[{\tt doc/guide\_html}] DB-ALLe Manual for Advanced Users and Administrators, in HTML format.
\item[{\tt doc/guide.ps}] DB-ALLe Manual for Advanced Users and Administrators, in PostScript format.
\end{description}


\section {\dballe{} directory layout}
\label{install-dir-layout}

These are the various files and directories installed by \dballe{} (assuming
{\tt ./configure} was invoked with {\tt --prefix=/usr/local}, {\tt
--localstatedir=/usr/local/var} and {\tt --sysconfdir=/usr/local/etc}):

\begin{description}
\item[{\tt /usr/local/bin}]
	\dballe{} tools: {\tt dbatbl}, {\tt dbamsg} and {\tt dbadb}.
\item[{\tt /usr/local/share/man/man1}]
	Manpages for the \dballe{} tools.
\item[{\tt /usr/local/include/dballe}]
	Include files for building applications that use \dballe{}.
\item[{\tt /usr/local/lib}]
	Compiled libraries.
\item[{\tt /usr/local/lib/pkgconfig}]
	pkg-config metadata about the library.
\item[{\tt /usr/local/share/aclocal}]
	autoconf macro for using the library.
\item[{\tt /usr/local/share/doc}]
	Documentation.
\item[{\tt /usr/local/share/dballe}]
	Tables in text format.
\item[{\tt /usr/local/etc/dballe}]
	Configuration files.
\end{description}
